# Лабораторная работа: Fine-Tuning моделей для классификации изображений

Этот проект является выполнением лабораторной работы по машинному обучению. Цель - собрать собственный набор данных, дообучить на нем две предобученные модели, сравнить их и создать простое веб-приложение для демонстрации лучшей модели.

## Описание набора данных

- **Тема:** Классификация типов наземного транспорта.
- **Классы:**
    1.  `leopards`
    2.  `pumas` 
    3.  `tigers` 
- **Объем:** Более 1000 изображений, собранных вручную из открытых источников. Данные разделены в соотношении 80/20 на обучающую и валидационную выборки.
- **Предобработка:** Изображения приводятся к размеру 224x224, применяется аугментация (случайные повороты и отражения) для обучающей выборки и нормализация для всех изображений.

## Результаты экспериментов

В ходе экспериментов (`experiments/lab_notebook.ipynb`) были дообучены две модели из библиотеки `timm`: **ResNet18** и **EfficientNet_b0**.

- **ResNet18** достигла точности ~95.7% на валидационной выборке.
- **EfficientNet_b0** показала схожую точность (~95.2%), но с более низким значением функции потерь, что указывает на большую "уверенность" модели.

На основе этих результатов **EfficientNet_b0 была выбрана как лучшая модель** для дальнейшего использования. При полном дообучении в скрипте `train.py` модель достигла точности **~97%**.

## Структура проекта

-   `/data/raw`: содержит исходные изображения, отсортированные по папкам-классам.
-   `/experiments`: содержит Jupyter Notebook (`lab_notebook.ipynb`) со всеми этапами исследования.
-   `/app`: содержит веб-приложение на Gradio (`app.py`) и экспортированную модель (`model.onnx`).
-   `train.py`: скрипт для полного воспроизводимого обучения лучшей модели.
-   `requirements.txt`: список необходимых библиотек для установки.

## Настройка и запуск

### 1. Настройка окружения

1.  Клонируйте репозиторий (или просто скачайте архив с файлами).
2. **Распакуйте архив `dataset.zip` в папку `/data/raw/...`**
3.  Убедитесь, что у вас установлен Python 3.9+.
4.  Откройте терминал в корневой папке проекта и установите все зависимости:
    ```bash
    pip install -r requirements.txt
    ```
    *На Windows рекомендуется использовать `py -m pip install -r requirements.txt`*

### 2. Воспроизведение обучения

Для запуска процесса обучения лучшей модели (EfficientNet_b0) с нуля, выполните в терминале из корневой папки проекта:
```bash
python train.py
```

На Windows рекомендуется использовать py train.py

Скрипт обучит модель в течение 5 эпох и сохранит веса лучшей итерации в файл efficientnet_b0_best.pth.

### 3. Запуск веб-приложения

Для запуска демонстрационного веб-приложения:

Перейдите в папку app:

```bash
cd app
```

Запустите приложение:

```bash
python app.py
```

На Windows рекомендуется использовать py app.py

В терминале появится ссылка (вида http://127.0.0.1:7860 или публичная ...gradio.live). Откройте ее в браузере, чтобы воспользоваться классификатором.